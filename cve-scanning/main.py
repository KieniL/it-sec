import json
import requests
import time



baseURL = 'https://services.nvd.nist.gov/rest/json/cve/1.0/'


with open('cvetest.json', 'r') as f:
    cve = json.load(f)


for i in range(len(cve)):
    for key in cve[i]:
        print(key)
        r = requests.get(baseURL + key)
        cve[i][key].insert(0, json.loads(json.dumps(r.json(), indent=2)))
        time.sleep(1.3) # set a time to not run into trouble to do too many requests in a little amount of time
        #cve[i][key].prepend(json.loads(json.dumps(r.json(), indent=2)))


with open('cve_with_description.json', 'w') as outfile:
    json.dump(cve, outfile)
